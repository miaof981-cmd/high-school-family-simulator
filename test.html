<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>é«˜ä¸­å®¶æ ¡ç”Ÿæ´»æ¨¡æ‹Ÿ Â· ç¬¬0å…³æµ‹è¯•é¡µ</title>
<style>
  /* ============= B. UI è§„èŒƒï¼ˆå¼ºåˆ¶ï¼‰ ============= */
  .phone{position:relative;width:390px;height:780px;margin:24px auto;background:#fff;
         border:2px solid #D8DCE1;border-radius:24px;overflow:hidden}
  .phone .main{position:absolute;left:0;right:0;top:52px;bottom:64px;overflow:hidden}
  .phone nav{position:absolute;left:0;right:0;bottom:0;height:64px;background:#fff;border-top:1px solid #ECEFF3}

  /* é¡¶éƒ¨æ¡ï¼ˆå ä½ 52pxï¼Œéè§„èŒƒä¸€éƒ¨åˆ†ï¼Œä»…ç”¨äºæ¼”ç¤ºï¼‰ */
  .topbar{position:absolute;left:0;right:0;top:0;height:52px;display:flex;align-items:center;justify-content:center;
          background:#FFFFFF;border-bottom:1px solid #ECEFF3;font:14px/1.2 system-ui;color:#4B5563}

  /* èŠå¤©é¡µ */
  .chat-area{position:absolute;left:0;right:0;top:0;bottom:60px;overflow:auto;padding:12px 10px;background:#F7F8FA}
  .chat-input{position:absolute;left:0;right:0;bottom:0;height:60px;display:flex;gap:8px;padding:10px;background:#fff;border-top:1px solid #ECEFF3}

  .msg{max-width:78%;margin:8px 10px;padding:10px 12px;border-radius:14px;position:relative;line-height:1.4;background:#EEF1F6;
       word-break:break-word;overflow-wrap:anywhere;}
  .msg.me{margin-left:auto;background:#DCF8C6}
  .msg .time{position:absolute;bottom:6px;font-size:11px;color:#8A8F99}
  .msg.me .time{right:8px}.msg.other .time{left:8px}
  .msg.me .ack{position:absolute;right:8px;bottom:6px;font-size:11px;color:#8A8F99} /* å›æ‰§åœ¨æ°”æ³¡å†…å³ä¸‹è§’ */
  .msg.system{margin:6px auto;background:#F3F5F9;color:#6B7280;font-size:12px}

  .modal{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.35);z-index:1100}
  .modal.show{display:flex}
  .attribute-feedback,.notification{z-index:900} /* æ°¸è¿œä½äº modal */

  /* æ¼”ç¤ºç”¨æŒ‰é’®æ ·å¼ï¼ˆéè§„èŒƒéƒ¨åˆ†ï¼‰ */
  .btn{display:inline-flex;align-items:center;justify-content:center;border:1px solid #D1D5DB;border-radius:10px;height:40px;padding:0 12px;font:13px system-ui;color:#374151;background:#fff}
  .btn:active{transform:translateY(1px)}
  .chat-input .btn{flex:0 0 auto}
  .chat-input .input{flex:1 1 auto;border:1px solid #E5E7EB;border-radius:10px;height:38px;padding:0 10px;font:14px system-ui;color:#111827;background:#fff}
</style>
</head>
<body>

<div class="phone">
  <div class="topbar">è”ç³»å­©å­</div>

  <div class="main">
    <div id="chat" class="chat-area"></div>
    <div class="chat-input">
      <!-- ç¬¬0å…³ä»…å ä½ï¼Œä¸æ¥å…¥åŠŸèƒ½ï¼›åç»­å…³å¡å†å¯ç”¨ -->
      <input class="input" type="text" placeholder="ç¬¬0å…³ä»…æ¼”ç¤ºå¸ƒå±€â€¦" disabled />
      <button class="btn" disabled>å‘é€</button>
    </div>
  </div>

  <nav></nav>
</div>

<script>
/* ============= C. æ•°æ®æ¨¡å‹ï¼ˆæœ€å°å­é›†ï¼Œæ¼”ç¤ºç”¨ï¼‰ ============= */
const state = {
  slot: 'class', // class | noonBreak | nightStudy | afterNightStudy | night
  dm:    [ /* {id, from:'parent'|'child'|'system', text, ts, status:'delivered'|'read'} */ ]
};

/* ============= æ¸²æŸ“ï¼šç§èŠæ¶ˆæ¯åˆ—è¡¨ ============= */
function addDM(from, text, status='read'){
  const msg = { id: Date.now()+Math.random(), from, text:String(text||''), ts: Date.now(), status };
  state.dm.push(msg); renderDM();
}
function renderDM(){
  const wrap = document.getElementById('chat');
  wrap.innerHTML = '';
  state.dm.forEach(m=>{
    const div = document.createElement('div');
    div.className = 'msg ' + (m.from==='child' ? 'other' : (m.from==='parent' ? 'me' : 'system'));
    div.textContent = m.text;
    if(m.from!=='system'){
      const t = document.createElement('div');
      t.className = 'time';
      const d = new Date(m.ts);
      t.textContent = `${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;
      div.appendChild(t);
    }
    wrap.appendChild(div);
  });
  wrap.scrollTop = wrap.scrollHeight + 999;
}

/* ============= ç¬¬0å…³ï¼šé¢„ç½®ä¸€æ¡å­©å­æ¶ˆæ¯ ============= */
addDM('child','ï¼ˆç¤ºä¾‹ï¼‰ä»Šå¤©æ•°å­¦å°æµ‹ï¼Œè¿˜ç®—é¡ºåˆ©ï½','read');
</script>
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>æµ‹è¯•é¡µ</title>
  <style>
    /* ä½ çš„ CSS */
  </style>
</head>
<body>
  <div class="phone">
    <!-- ä½ çš„èŠå¤© UI -->
  </div>

  <script>
    // ä½ çš„ä¸»é€»è¾‘ JS
  </script>

  <!-- ğŸ§ª å†’çƒŸæµ‹è¯•è„šæœ¬ -->
  <script>
  (function smoke(){
    const host = document.querySelector('.phone');
    const warn = msg=>{
      let box = document.getElementById('smoke'); 
      if(!box){ 
        box=document.createElement('div'); 
        box.id='smoke'; 
        host.appendChild(box);
        Object.assign(box.style,{
          position:'absolute',left:'8px',bottom:'72px',
          background:'#fff5f5',border:'1px solid #ff4d4f',
          padding:'6px 8px',borderRadius:'8px',
          font:'12px/1.4 system-ui',maxWidth:'80%'
        });
      }
      box.textContent = msg;
    };
    if(!host) return;
    const ib = document.querySelector('.chat-input');
    if(!ib || getComputedStyle(ib).position!=='absolute') 
      return warn('âŒ è¾“å…¥æ¡å¿…é¡»ç»å¯¹å®šä½åœ¨ .phone å†…éƒ¨åº•éƒ¨');
    const ch = document.querySelectorAll('.choices .choice');
    if(ch.length && ch.length!==3) 
      return warn('âŒ é€‰é¡¹å¿…é¡» 3 ä¸ªï¼Œä¸”åªæ˜¾ç¤ºä¸€ç»„ï¼ˆ123ï¼‰');
    const myAcks = document.querySelectorAll('.msg.me .ack');
    if(myAcks.length>1) 
      return warn('âŒ å›æ‰§åªèƒ½å‡ºç°åœ¨â€œæˆ‘æ–¹æœ€åä¸€æ¡â€æ°”æ³¡å†…');
  })();
  </script>
</body>
</html>

